(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-354f1447"],{1148:function(e,t,r){"use strict";var a=r("5926"),n=r("577e"),i=r("1d80"),o=RangeError;e.exports=function(e){var t=n(i(this)),r="",s=a(e);if(s<0||s===1/0)throw new o("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(t+=t))1&s&&(r+=t);return r}},"2f12":function(e,t,r){"use strict";r.r(t);var a=r("3835"),n=(r("99af"),r("a15b"),r("d81d"),r("b0c0"),r("e9f5"),r("7d54"),r("ab43"),r("4fad"),r("d3b7"),r("159b"),r("7f29")),i="http://10.23.56.29:8090/iserver/services/data-gis-2/rest/data",o=200;t["default"]={data:function(){return{map:null,pointLayer:null,linesLayer:null,dialogVisible:!1,isBianPo:!1,resultBoundsLayer:null,form:{city:""},districtDisasterModel:{southern:0,central:0,northern:0},disasterTypeModel:{bt:0,tx:0,hp:0,nsl:0,sh:0},rectificationProgressModel:{total:0,already:0,deal:0}}},computed:{disasterTypeCount:function(){var e=this.disasterTypeModel,t=e.bt,r=e.tx,a=e.hp,n=e.nsl,i=e.sh,o=t+r+a+n+i;return o},disasterTypeOption:function(){var e=this.disasterTypeModel,t=e.bt,r=e.tx,a=e.hp,i=e.nsl,o=e.sh,s=this.disasterTypeCount;return[{name:"崩塌",value:t,percent:Object(n["a"])(t,s),color:"#A780FF"},{name:"塌陷",value:r,percent:Object(n["a"])(r,s),color:"#3C9EFF"},{name:"滑坡",value:a,percent:Object(n["a"])(a,s),color:"#47E2DF"},{name:"泥石流",value:i,percent:Object(n["a"])(i,s),color:"#3EFF99"},{name:"水毁",value:o,percent:Object(n["a"])(o,s),color:"#FFD84A"}]}},mounted:function(){var e=this;this.$nextTick((function(){e.initMap()}))},methods:{refreshMap:function(){var e=this.map;e.getZoom()},clearLayersFeatures:function(){this.clearBoundsFeatures(),this.clearPointLayerFeatures(),this.clearLinesLayerFeatures()},initMap:function(){var e=L.map("map",{center:[35.8617,104.1954],zoom:3.5,zoomSnap:.25,crs:L.supermap.CRS.TianDiTu_WGS84,zoomControl:!1});this.linesLayer=(new L.LayerGroup).addTo(e),this.pointLayer=(new L.LayerGroup).addTo(e);var t="1d109683f4d84198e37a38c442d68311";new L.supermap.TiandituTileLayer({layerType:"img",key:t}).addTo(e),new L.supermap.TiandituTileLayer({layerType:"img",isLabel:!0,key:t}).addTo(e),new L.supermap.TiledMapLayer("http://10.23.17.229:8090/iserver/services/map-gis-disaster--3--2/rest/maps/DataSource%40disaster-provincial-highway",{transparent:!0,noWrap:!0}).addTo(e),new L.supermap.TiledMapLayer("http://10.23.17.229:8090/iserver/services/map-gis-disaster--3--2/rest/maps/DataSource%40disaster-national-highway",{transparent:!0,noWrap:!0}).addTo(e),new L.supermap.TiledMapLayer("http://10.23.17.229:8090/iserver/services/map-gis-disaster--3--2/rest/maps/pointMap",{transparent:!0,noWrap:!0}).addTo(e),this.map=e},polygonToGeoJSON:function(e){var t=e.getVertices(),r=t.map((function(e){return[e.x,e.y]})),a={type:"Feature",geometry:{type:"Polygon",coordinates:[r]},properties:{}};return a},boundsToGeometry:function(e){var t=e.getSouthWest(),r=e.getNorthEast(),a=[new SuperMap.Geometry.Point(t.lng,t.lat),new SuperMap.Geometry.Point(r.lng,t.lat),new SuperMap.Geometry.Point(r.lng,r.lat),new SuperMap.Geometry.Point(t.lng,r.lat),new SuperMap.Geometry.Point(t.lng,t.lat)],n=new SuperMap.Geometry.LinearRing(a);return new SuperMap.Geometry.Polygon([n])},clearBoundsFeatures:function(){this.map;if(this.resultBoundsLayer){var e=this.resultBoundsLayer;e.clearLayers()}},clearPointLayerFeatures:function(){this.map;if(this.pointLayer){var e=this.pointLayer;e.clearLayers()}},clearLinesLayerFeatures:function(){this.map;if(this.linesLayer){var e=this.linesLayer;e.clearLayers()}},loadLines:function(){this.clearLinesLayerFeatures();var e=this.map,t=this,r=e.getBounds(),n=new SuperMap.Bounds(r.getWest(),r.getSouth(),r.getEast(),r.getNorth()),s=["#0078FF","#FF5733","#2ECC71"],u=["DataSourceGIS2:gz_L21_52_G","DataSourceGIS2:gz_L21_52_S"],c=function(e,r,n,s,u){var p=n*o,l=p+o,d=new SuperMap.GetFeaturesByBoundsParameters({datasetNames:[e],bounds:r,returnContent:!0,fromIndex:p,toIndex:l}),f=new SuperMap.GetFeaturesByBoundsService(i);f.processAsync(d,(function(i){if(i.result&&i.result.features){var p=L.geoJSON(i.result.features,{style:{color:u,weight:5},onEachFeature:function(e,t){t.on("click",(function(){console.log(e,"1-----1");var r=e.properties,n=r.name||r.名称||"未命名线路",i=Object.entries(r).map((function(e){var t=Object(a["a"])(e,2),r=t[0],n=t[1];return"<b>".concat(r,":</b> ").concat(n)})).join("<br>");t.bindPopup("<h4>".concat(n,"</h4>").concat(i)).openPopup()}))}});t.linesLayer.addLayer(p),i.result.featureCount===o&&c(e,r,n+1,s,u)}}))};u.forEach((function(e,t){c(e,n,0,[],s[t%3])}))},renderVisiblePoints:function(){var e=this,t=this.map,r=this.pointLayer,n=t.getBounds(),o=n.getSouthWest(),s=n.getNorthEast(),u=L.icon.pulse({iconSize:[12,12],color:"#f00"});this.clearPointLayerFeatures();var c=new SuperMap.GetFeaturesByBoundsParameters({queryParams:{name:"address_disaster@DataSourceDisasterGIS",attributeFilter:"disaster_grade = '一级'"},datasetNames:["DataSourceDisasterGIS:address_disaster"],bounds:new SuperMap.Bounds(o.lng,o.lat,s.lng,s.lat),fromIndex:0,toIndex:50,spatialQueryMode:SuperMap.SpatialQueryMode.CONTAIN});L.supermap.featureService(i).getFeaturesByBounds(c,(function(t){var n=t.result.features.features;n.forEach((function(t){var n=Object(a["a"])(t.geometry.coordinates,2),i=n[0],o=n[1],s=L.marker([o,i],{icon:u}).addTo(r);s.on("click",(function(){console.log(t,"1----1")})),e.pointLayer.addLayer(layer)}))}))},refreshDataView:function(){},queryDisasterDataset:function(e,t){return new Promise((function(r,a){new L.supermap.FeatureService(e).getFeaturesBySQL(t).then((function(e){r(e)})).catch((function(e){a(e)}))}))}}}},"4fad":function(e,t,r){"use strict";var a=r("23e7"),n=r("6f53").entries;a({target:"Object",stat:!0},{entries:function(e){return n(e)}})},"6f53":function(e,t,r){"use strict";var a=r("83ab"),n=r("d039"),i=r("e330"),o=r("e163"),s=r("df75"),u=r("fc6a"),c=r("d1e7").f,p=i(c),l=i([].push),d=a&&n((function(){var e=Object.create(null);return e[2]=2,!p(e,2)})),f=function(e){return function(t){var r,n=u(t),i=s(n),c=d&&null===o(n),f=i.length,h=0,y=[];while(f>h)r=i[h++],a&&!(c?r in n:p(n,r))||l(y,e?[r,n[r]]:n[r]);return y}};e.exports={entries:f(!0),values:f(!1)}},"7f29":function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return n})),r.d(t,"b",(function(){return i}));r("a9e3"),r("b680"),r("d3b7"),r("25f0");function a(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Number(e||0);if(!a)return"0.00";var n=a/t;return r&&(n*=100),n.toFixed(2)}function n(e){return(e/1e4).toFixed(2)}function i(e){return e>=1e4?n(e).toString()+"万":e.toString()+"个"}},b680:function(e,t,r){"use strict";var a=r("23e7"),n=r("e330"),i=r("5926"),o=r("408a"),s=r("1148"),u=r("d039"),c=RangeError,p=String,l=Math.floor,d=n(s),f=n("".slice),h=n(1..toFixed),y=function(e,t,r){return 0===t?r:t%2===1?y(e,t-1,r*e):y(e*e,t/2,r)},m=function(e){var t=0,r=e;while(r>=4096)t+=12,r/=4096;while(r>=2)t+=1,r/=2;return t},g=function(e,t,r){var a=-1,n=r;while(++a<6)n+=t*e[a],e[a]=n%1e7,n=l(n/1e7)},L=function(e,t){var r=6,a=0;while(--r>=0)a+=e[r],e[r]=l(a/t),a=a%t*1e7},v=function(e){var t=6,r="";while(--t>=0)if(""!==r||0===t||0!==e[t]){var a=p(e[t]);r=""===r?a:r+d("0",7-a.length)+a}return r},w=u((function(){return"0.000"!==h(8e-5,3)||"1"!==h(.9,0)||"1.25"!==h(1.255,2)||"1000000000000000128"!==h(0xde0b6b3a7640080,0)}))||!u((function(){h({})}));a({target:"Number",proto:!0,forced:w},{toFixed:function(e){var t,r,a,n,s=o(this),u=i(e),l=[0,0,0,0,0,0],h="",w="0";if(u<0||u>20)throw new c("Incorrect fraction digits");if(s!==s)return"NaN";if(s<=-1e21||s>=1e21)return p(s);if(s<0&&(h="-",s=-s),s>1e-21)if(t=m(s*y(2,69,1))-69,r=t<0?s*y(2,-t,1):s/y(2,t,1),r*=4503599627370496,t=52-t,t>0){g(l,0,r),a=u;while(a>=7)g(l,1e7,0),a-=7;g(l,y(10,a,1),0),a=t-1;while(a>=23)L(l,1<<23),a-=23;L(l,1<<a),g(l,1,1),L(l,2),w=v(l)}else g(l,0,r),g(l,1<<-t,0),w=v(l)+d("0",u);return u>0?(n=w.length,w=h+(n<=u?"0."+d("0",u-n)+w:f(w,0,n-u)+"."+f(w,n-u))):w=h+w,w}})}}]);