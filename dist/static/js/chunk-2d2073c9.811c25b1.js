(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d2073c9"],{a059:function(e,t,a){"use strict";a.r(t);var r=a("3835"),n=a("5530"),o=(a("99af"),a("d81d"),a("14d9"),a("e9f5"),a("7d54"),a("ab43"),a("d3b7"),a("159b"),"http://10.23.17.229:8090/iserver/services/data-gis-disaster--3--2/rest/data"),s=200;t["default"]={data:function(){return{}},methods:{loadLineByPage:function(){var e=this.map,t=this,a=e.getBounds(),r=new SuperMap.Bounds(a.getWest(),a.getSouth(),a.getEast(),a.getNorth()),n=["#0078FF","#FF5733"],o=["11","12","13","14","15","21","22","23","31","32","33","34","35","36","37","41","42","43","44","45","46","50","51","52","53","54","61","62","63","64","65","66"],s=[];o.forEach((function(e){s.push("highway:L21_"+e+"_G"),s.push("highway-S:L21_"+e+"_S")})),this.dataSourceRequest(s,r,0,n).then((function(){console.log("所有道路数据请求处理完成"),t.renderVisiblePointsAll()})).catch((function(e){console.error("请求过程中出现错误:",e)}))},requestDatasourceBydatasetName:function(e,t,a,r,n){return new Promise((function(n,s){var u=new SuperMap.GetFeaturesByBoundsParameters({datasetNames:[e],bounds:t,returnContent:!0,fromIndex:a,toIndex:r}),i=new SuperMap.GetFeaturesByBoundsService(o);i.processAsync(u).then((function(e){n(e)})).catch((function(e){s(e)}))}))},dataSourceRequest:function(e,t,a,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,u=this;if(o>=e.length)return Promise.resolve();var i=e[o],c=a*s,l=c+s;return u.requestDatasourceBydatasetName(i,t,c,l,r).then((function(c){if(c.result&&c.result.features){var l=L.geoJSON(c.result.features,{style:{color:r[o%2],weight:5},onEachFeature:function(e,t){t.on("click",(function(e){var t=e.target.feature.properties||{},a="".concat(t.F03||"");u.dialogVisibleHightWayModel=Object(n["a"])({title:a},t),setTimeout((function(){u.dialogVisibleHightWay=!0}),300)}))}});if(u.linesLayer.addLayer(l),console.log(c.result,s,"1---1"),c.result.featureCount===s){var d=(a+1)*s,f=d+s;return u.requestDatasourceBydatasetName(i,t,d,f,r)}return u.dataSourceRequest(e,t,0,r,o+1).then((function(){}))}})).catch((function(e){return console.error("处理数组时出错:",e),Promise.reject(e)}))},renderVisiblePointsAll:function(){var e=this.map,t=this.pointLayer,a=e.getBounds(),u=a.getSouthWest(),i=a.getNorthEast(),c=this;this.clearPointLayerFeatures();var l=function(a){var d=a*s,f=d+s,p=new SuperMap.GetFeaturesByBoundsParameters({queryParams:{name:"all_User@allpoint-2"},datasetNames:["allpoint-2:all_User"],bounds:new SuperMap.Bounds(u.lng,u.lat,i.lng,i.lat),returnContent:!0,fromIndex:d,toIndex:f,spatialQueryMode:SuperMap.SpatialQueryMode.CONTAIN}),h=new SuperMap.GetFeaturesByBoundsService(o);h.processAsync(p,(function(o){var u=o.result.features.features;u.forEach((function(e){var a=Object(r["a"])(e.geometry.coordinates,2),o=a[0],s=a[1],u="";switch(e.properties.灾害等级){case"一级":u="red";break;case"二级":u="orange";break;case"三级":u="yellow";break;default:u="blue"}var i=L.circleMarker([s,o],{radius:8,color:u,fillOpacity:1,fillColor:u,zIndexOffset:9999}).addTo(t);i.on("click",(function(){var t=e.properties||{},a="".concat(t.END_STATION_NUMBER||"","灾害点-").concat(t.DS_TYPE);c.dialogVisibleModel=Object(n["a"])({title:a},t),setTimeout((function(){c.dialogVisible=!0}),300)}))})),e.addLayer(c.pointLayer),o.result.featureCount-1===s&&l(a+1)}))};l(0)}}}}}]);