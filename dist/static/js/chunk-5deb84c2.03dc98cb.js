(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5deb84c2","chunk-425d8fd8","chunk-2d0deb42"],{1148:function(e,t,a){"use strict";var r=a("5926"),n=a("577e"),s=a("1d80"),i=RangeError;e.exports=function(e){var t=n(s(this)),a="",o=r(e);if(o<0||o===1/0)throw new i("Wrong number of repetitions");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(a+=t);return a}},"33b5":function(e,t,a){"use strict";a.r(t);var r=a("c7eb"),n=a("1da1"),s=a("3835"),i=(a("99af"),a("a15b"),a("d81d"),a("b0c0"),a("e9f5"),a("7d54"),a("ab43"),a("4fad"),a("d3b7"),a("159b"),a("7f29")),o=(a("ebc5"),a("8d5e")),u=a.n(o),c=a("877d"),d="http://10.23.56.29:8090/iserver/services/data-gis-2/rest/data",l="address_disaster@DataSourceDisasterGIS",p=200;t["default"]={data:function(){return{map:null,pointLayer:null,linesLayer:null,dialogVisible:!1,riskdialogVisible1:!1,riskdialogVisible2:!1,isBianPo:!1,resultBoundsLayer:null,weatherPoint:{},form:{city:""},districtDisasterModel:{southern:0,central:0,northern:0},disasterTypeModel:{bt:0,tx:0,hp:0,nsl:0,sh:0},rectificationProgressModel:{total:0,already:0,deal:0}}},computed:{disasterTypeCount:function(){var e=this.disasterTypeModel,t=e.bt,a=e.tx,r=e.hp,n=e.nsl,s=e.sh,i=t+a+r+n+s;return i},disasterTypeOption:function(){var e=this.disasterTypeModel,t=e.bt,a=e.tx,r=e.hp,n=e.nsl,s=e.sh,o=this.disasterTypeCount;return[{name:"崩塌",value:t,percent:Object(i["a"])(t,o),color:"#A780FF"},{name:"塌陷",value:a,percent:Object(i["a"])(a,o),color:"#3C9EFF"},{name:"滑坡",value:r,percent:Object(i["a"])(r,o),color:"#47E2DF"},{name:"泥石流",value:n,percent:Object(i["a"])(n,o),color:"#3EFF99"},{name:"水毁",value:s,percent:Object(i["a"])(s,o),color:"#FFD84A"}]}},mounted:function(){var e=this;this.$nextTick((function(){e.initMap(),e.refreshDataView()}))},methods:{refreshMap:function(){var e=this.map;e.getZoom()},clearLayersFeatures:function(){this.clearBoundsFeatures(),this.clearPointLayerFeatures(),this.clearLinesLayerFeatures()},initMap:function(){var e=this,t=L.map("map",{center:[30.76,103.96],zoom:5,crs:L.supermap.CRS.TianDiTu_WGS84,zoomControl:!1});this.linesLayer=(new L.LayerGroup).addTo(t),this.pointLayer=(new L.LayerGroup).addTo(t);var a="1d109683f4d84198e37a38c442d68311";new L.supermap.TiandituTileLayer({key:a}).addTo(t),new L.supermap.TiandituTileLayer({layerType:"img",key:a}).addTo(t),new L.supermap.TiandituTileLayer({layerType:"img",isLabel:!0,key:a}).addTo(t);new L.supermap.TiledMapLayer("http://10.23.17.229:8090/iserver/services/map-gis-disaster--2--4/rest/maps/DataSourceGIS2-sichuan",{transparent:!0,noWrap:!0}).addTo(t);new L.supermap.TiledMapLayer("http://10.23.56.29:8090/iserver/services/map-Precipitation/rest/maps/PrecipitationMap",{transparent:!0,noWrap:!0}).addTo(t);new L.supermap.TiledMapLayer("http://10.23.17.229:8090/iserver/services/map-gis-disaster--2--4/rest/maps/DataSourceGIS2-sichuan",{transparent:!0,noWrap:!0}).addTo(t);var r=L.icon({iconUrl:u.a,iconSize:[70,70]});c["weatherData"].forEach((function(a){var n=L.marker([a.latitude,a.longitude],{icon:r}).addTo(t);n.on("click",(function(){e.weatherPoint=a,setTimeout((function(){e.riskdialogVisible2=!0}),300)}))})),this.map=t},polygonToGeoJSON:function(e){var t=e.getVertices(),a=t.map((function(e){return[e.x,e.y]})),r={type:"Feature",geometry:{type:"Polygon",coordinates:[a]},properties:{}};return r},boundsToGeometry:function(e){var t=e.getSouthWest(),a=e.getNorthEast(),r=[new SuperMap.Geometry.Point(t.lng,t.lat),new SuperMap.Geometry.Point(a.lng,t.lat),new SuperMap.Geometry.Point(a.lng,a.lat),new SuperMap.Geometry.Point(t.lng,a.lat),new SuperMap.Geometry.Point(t.lng,t.lat)],n=new SuperMap.Geometry.LinearRing(r);return new SuperMap.Geometry.Polygon([n])},clearBoundsFeatures:function(){this.map;if(this.resultBoundsLayer){var e=this.resultBoundsLayer;e.clearLayers()}},clearPointLayerFeatures:function(){this.map;if(this.pointLayer){var e=this.pointLayer;e.clearLayers()}},clearLinesLayerFeatures:function(){this.map;if(this.linesLayer){var e=this.linesLayer;e.clearLayers()}},loadLines:function(){this.clearLinesLayerFeatures();var e=this.map,t=this,a=e.getBounds(),r=new SuperMap.Bounds(a.getWest(),a.getSouth(),a.getEast(),a.getNorth()),n=["#0078FF","#FF5733","#2ECC71"],i=["DataSourceGIS2:gz_L21_52_G","DataSourceGIS2:gz_L21_52_S"],o=function(e,a,r,n,i){var u=r*p,c=u+p,l=new SuperMap.GetFeaturesByBoundsParameters({datasetNames:[e],bounds:a,returnContent:!0,fromIndex:u,toIndex:c}),f=new SuperMap.GetFeaturesByBoundsService(d);f.processAsync(l,(function(u){if(u.result&&u.result.features){var c=L.geoJSON(u.result.features,{style:{color:i,weight:5},onEachFeature:function(e,t){t.on("click",(function(){console.log(e,"1-----1");var a=e.properties,r=a.name||a.名称||"未命名线路",n=Object.entries(a).map((function(e){var t=Object(s["a"])(e,2),a=t[0],r=t[1];return"<b>".concat(a,":</b> ").concat(r)})).join("<br>");t.bindPopup("<h4>".concat(r,"</h4>").concat(n)).openPopup()}))}});t.linesLayer.addLayer(c),u.result.featureCount===p&&o(e,a,r+1,n,i)}}))};i.forEach((function(e,t){o(e,r,0,[],n[t%3])}))},loadLinesByBounds:function(e){this.clearBoundsFeatures();var t=this,a=this.map;t.loading=!0;var r=this.polygonToGeoJSON(this.boundsToGeometry(a.getBounds())),n=L.supermap.Util.transform(r,L.CRS.EPSG4326,L.CRS.EPSG3857),s=new L.supermap.QueryByGeometryParameters({queryParams:{name:"China_Province_pl@China"},featureCount:1e6,geometry:n,spatialQueryMode:SuperMap.SpatialQueryMode.INTERSECT}),i=new L.supermap.QueryService("http://10.23.17.229:8090/iserver/services/map-china400/rest/maps/China");i.queryByGeometry(s,(function(e){t.loading=!1;var r=L.supermap.Util.transform(e.result.recordsets[0].features,L.CRS.EPSG3857,L.CRS.EPSG4326);t.resultBoundsLayer=L.geoJSON(r).addTo(a)}))},renderVisiblePoints:function(){var e=this,t=this.map,a=this.pointLayer,r=t.getBounds(),n=r.getSouthWest(),i=r.getNorthEast(),o=L.icon.pulse({iconSize:[12,12],color:"#f00"});this.clearPointLayerFeatures();var u=new SuperMap.GetFeaturesByBoundsParameters({queryParams:{name:"address_disaster@DataSourceDisasterGIS",attributeFilter:"disaster_grade = '一级'"},datasetNames:["DataSourceDisasterGIS:address_disaster"],bounds:new SuperMap.Bounds(n.lng,n.lat,i.lng,i.lat),fromIndex:0,toIndex:50,spatialQueryMode:SuperMap.SpatialQueryMode.CONTAIN});L.supermap.featureService(d).getFeaturesByBounds(u,(function(t){var r=t.result.features.features;r.forEach((function(t){var r=Object(s["a"])(t.geometry.coordinates,2),n=r[0],i=r[1],u=L.marker([i,n],{icon:o}).addTo(a);u.on("click",(function(){console.log(t,"1----1")})),e.pointLayer.addLayer(layer)}))}))},refreshDataView:function(){this.getDistrictDisaster(),this.getDisasterType(),this.getRectificationProgress()},getDistrictDisaster:function(){return Object(n["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},getDisasterType:function(){var e=this;return Object(n["a"])(Object(r["a"])().mark((function t(){var a,n,s,i,o,u,c,p,f,m,h;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=function(e,t){var a=new L.supermap.GetFeaturesBySQLParameters({queryParameter:{name:e,attributeFilter:t},datasetNames:["DataSourceDisasterGIS:address_disaster"]});return a},n="ds_type = '崩塌'",t.next=4,e.queryDisasterDataset(d,a(l,n));case 4:return s=t.sent,e.disasterTypeModel.bt=s.result.totalCount||0,i="ds_type = '塌陷'",t.next=9,e.queryDisasterDataset(d,a(l,i));case 9:return o=t.sent,e.disasterTypeModel.tx=o.result.totalCount||0,u="ds_type = '滑坡'",t.next=14,e.queryDisasterDataset(d,a(l,u));case 14:return c=t.sent,e.disasterTypeModel.hp=c.result.totalCount||0,p="ds_type = '泥石流'",t.next=19,e.queryDisasterDataset(d,a(l,p));case 19:return f=t.sent,e.disasterTypeModel.nsl=f.result.totalCount||0,m="ds_type = '水毁'",t.next=24,e.queryDisasterDataset(d,a(l,m));case 24:h=t.sent,e.disasterTypeModel.sh=h.result.totalCount||0;case 26:case"end":return t.stop()}}),t)})))()},getRectificationProgress:function(){var e=this;return Object(n["a"])(Object(r["a"])().mark((function t(){var a,n,s,i,o,u,c;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=function(e,t){var a=new L.supermap.GetFeaturesBySQLParameters({queryParameter:{name:e,attributeFilter:t},datasetNames:["DataSourceDisasterGIS:address_disaster"]});return a},n="treatment_situation = '已处治修复' or treatment_situation = '未处治修复' or treatment_situation = '正在处治修复'",t.next=4,e.queryDisasterDataset(d,a(l,n));case 4:return s=t.sent,e.rectificationProgressModel.total=s.result.totalCount||0,i="treatment_situation = '已处治修复'",t.next=9,e.queryDisasterDataset(d,a(l,i));case 9:return o=t.sent,e.rectificationProgressModel.already=o.result.totalCount||0,u="treatment_situation = '正在处治修复' or treatment_situation = '未处治修复'",t.next=14,e.queryDisasterDataset(d,a(l,u));case 14:c=t.sent,e.rectificationProgressModel.deal=c.result.totalCount||0;case 16:case"end":return t.stop()}}),t)})))()},queryDisasterDataset:function(e,t){return new Promise((function(a,r){new L.supermap.FeatureService(e).getFeaturesBySQL(t).then((function(e){a(e)})).catch((function(e){r(e)}))}))}}}},"4fad":function(e,t,a){"use strict";var r=a("23e7"),n=a("6f53").entries;r({target:"Object",stat:!0},{entries:function(e){return n(e)}})},"6f53":function(e,t,a){"use strict";var r=a("83ab"),n=a("d039"),s=a("e330"),i=a("e163"),o=a("df75"),u=a("fc6a"),c=a("d1e7").f,d=s(c),l=s([].push),p=r&&n((function(){var e=Object.create(null);return e[2]=2,!d(e,2)})),f=function(e){return function(t){var a,n=u(t),s=o(n),c=p&&null===i(n),f=s.length,m=0,h=[];while(f>m)a=s[m++],r&&!(c?a in n:d(n,a))||l(h,e?[a,n[a]]:n[a]);return h}};e.exports={entries:f(!0),values:f(!1)}},"7f29":function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return n})),a.d(t,"b",(function(){return s}));a("a9e3"),a("b680"),a("d3b7"),a("25f0");function r(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Number(e||0);if(!r)return"0.00";var n=r/t;return a&&(n*=100),n.toFixed(2)}function n(e){return(e/1e4).toFixed(2)}function s(e){return e>=1e4?n(e).toString()+"万":e.toString()+"个"}},"877d":function(e,t,a){"use strict";a.r(t),a.d(t,"weatherData",(function(){return r}));var r=[{id:"890660288133595136",name:"K36+735泥石流",code:"070G556530581NL0002",province_code:"530000",disaster_type:"泥石流",road_type:"普通公路",road_name:"镇安-瑞丽",longitude:"103.96",latitude:"30.76",route_code:"G556",start_pile:"K36+700",end_pile:"K36+770",admin_code:"530581",department:"腾冲公路分局",field_1:"",field_2:"",is_disrupted:"是",disaster_date:"2021-07-20",traffic_state:"交通中断",damage_part:"路面-路基-涵洞",field_3:"",has_damage1:"有",has_damage2:"无",has_damage3:"无",treatment:"无-抛石",field_4:"无",field_5:"其它",field_6:"无",repair_status:"已处治修复",damage_level:"较严重",impact_level:"严重",field_7:"",road_class:"二级公路",design_level:"三级",is_recorded:"已规档",disaster_grade:"二级（较大）",actual_road_class:"四级公路",field_8:"",overall_damage:"一般",overall_impact:"严重",final_status:"未处治修复",images:["https://tse2-mm.cn.bing.net/th/id/OIP-C.KpMC4r6qZBUBnYmBiiM6GQHaFj?rs=1&pid=ImgDetMain","https://youjia.cdn.bcebos.com/wenda_pics/16644463969688d2b5ca.png@!default_youjia","https://pic.vjshi.com/2023-08-14/c6c3d2a0798f45abba2c81a29b05a2a1/online/main.jpg?x-oss-process=style/w342_h192_center"]},{id:"915268464069836800",name:"K151+645滑坡",code:"070G5615532503HP0021",province_code:"530000",disaster_type:"滑坡",road_type:"高速公路",road_name:"天猴高速",longitude:"103.803288",latitude:"33.427603",route_code:"G5615",start_pile:"K151+590",end_pile:"K151+700",admin_code:"532503",department:"中交集团",field_1:"",field_2:"",is_disrupted:"是",disaster_date:"2021-08-20",traffic_state:"半幅通行",damage_part:"路面-路基",field_3:"路基",has_damage1:"无",has_damage2:"",has_damage3:"",treatment:"",field_4:"",field_5:"",field_6:"",repair_status:"未处治修复",damage_level:"中等",impact_level:"较严重",field_7:"",road_class:"高速公路",design_level:"二级",is_recorded:"已规档",disaster_grade:"二级（较大）",actual_road_class:"高速公路",field_8:"",overall_damage:"较严重",overall_impact:"中等",final_status:"未处治修复",images:["https://tse3-mm.cn.bing.net/th/id/OIP-C.qOtqPy1KdSnOKtfk7BUr8QHaE8?rs=1&pid=ImgDetMain","https://ts1.tc.mm.bing.net/th/id/R-C.8ec85bbbabf7822b19ccfeb20140381a?rik=J5NBLPBXEWjR%2bQ&riu=http%3a%2f%2fn.sinaimg.cn%2fsinacn%2fw480h282%2f20180208%2fa8cc-fyrkuxs2642985.jpg&ehk=PYOA3B3tOuCgIKf3XoEkNyutw45W9CKKAcvLyiIBrdg%3d&risl=&pid=ImgRaw&r=0","https://pic.52112.com/2020/03/11/JPG-200311_293/A9rd7wDCcs_small.jpg"]}]},"8d5e":function(e,t,a){e.exports=a.p+"static/img/icon-warning.99457d38.gif"},b680:function(e,t,a){"use strict";var r=a("23e7"),n=a("e330"),s=a("5926"),i=a("408a"),o=a("1148"),u=a("d039"),c=RangeError,d=String,l=Math.floor,p=n(o),f=n("".slice),m=n(1..toFixed),h=function(e,t,a){return 0===t?a:t%2===1?h(e,t-1,a*e):h(e*e,t/2,a)},y=function(e){var t=0,a=e;while(a>=4096)t+=12,a/=4096;while(a>=2)t+=1,a/=2;return t},g=function(e,t,a){var r=-1,n=a;while(++r<6)n+=t*e[r],e[r]=n%1e7,n=l(n/1e7)},_=function(e,t){var a=6,r=0;while(--a>=0)r+=e[a],e[a]=l(r/t),r=r%t*1e7},v=function(e){var t=6,a="";while(--t>=0)if(""!==a||0===t||0!==e[t]){var r=d(e[t]);a=""===a?r:a+p("0",7-r.length)+r}return a},b=u((function(){return"0.000"!==m(8e-5,3)||"1"!==m(.9,0)||"1.25"!==m(1.255,2)||"1000000000000000128"!==m(0xde0b6b3a7640080,0)}))||!u((function(){m({})}));r({target:"Number",proto:!0,forced:b},{toFixed:function(e){var t,a,r,n,o=i(this),u=s(e),l=[0,0,0,0,0,0],m="",b="0";if(u<0||u>20)throw new c("Incorrect fraction digits");if(o!==o)return"NaN";if(o<=-1e21||o>=1e21)return d(o);if(o<0&&(m="-",o=-o),o>1e-21)if(t=y(o*h(2,69,1))-69,a=t<0?o*h(2,-t,1):o/h(2,t,1),a*=4503599627370496,t=52-t,t>0){g(l,0,a),r=u;while(r>=7)g(l,1e7,0),r-=7;g(l,h(10,r,1),0),r=t-1;while(r>=23)_(l,1<<23),r-=23;_(l,1<<r),g(l,1,1),_(l,2),b=v(l)}else g(l,0,a),g(l,1<<-t,0),b=v(l)+p("0",u);return u>0?(n=b.length,b=m+(n<=u?"0."+p("0",u-n)+b:f(b,0,n-u)+"."+f(b,n-u))):b=m+b,b}})},ebc5:function(e,t,a){e.exports=a.p+"static/img/earthquake-warning.7783fa04.gif"}}]);