(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d9999908","chunk-2d0bd1f8"],{"1fdd":function(e,t,a){"use strict";a.r(t);var r=a("c7eb"),s=a("1da1"),n=a("3835"),i=(a("99af"),a("a15b"),a("d81d"),a("b0c0"),a("e9f5"),a("7d54"),a("ab43"),a("4fad"),a("d3b7"),a("159b"),a("7f29")),o=a("ebc5"),u=a.n(o),c=(a("8d5e"),a("2b3e")),d="http://10.23.56.29:8090/iserver/services/data-gis-2/rest/data",p="address_disaster@DataSourceDisasterGIS",l=200;t["default"]={data:function(){return{map:null,pointLayer:null,linesLayer:null,dialogVisible:!1,riskdialogVisible1:!1,riskdialogVisible2:!1,isBianPo:!1,resultBoundsLayer:null,form:{city:""},districtDisasterModel:{southern:0,central:0,northern:0},disasterTypeModel:{bt:0,tx:0,hp:0,nsl:0,sh:0},rectificationProgressModel:{total:0,already:0,deal:0},showPicScreen:!1,picSrc:"",earthquakePoint:{}}},computed:{disasterTypeCount:function(){var e=this.disasterTypeModel,t=e.bt,a=e.tx,r=e.hp,s=e.nsl,n=e.sh,i=t+a+r+s+n;return i},disasterTypeOption:function(){var e=this.disasterTypeModel,t=e.bt,a=e.tx,r=e.hp,s=e.nsl,n=e.sh,o=this.disasterTypeCount;return[{name:"崩塌",value:t,percent:Object(i["a"])(t,o),color:"#A780FF"},{name:"塌陷",value:a,percent:Object(i["a"])(a,o),color:"#3C9EFF"},{name:"滑坡",value:r,percent:Object(i["a"])(r,o),color:"#47E2DF"},{name:"泥石流",value:s,percent:Object(i["a"])(s,o),color:"#3EFF99"},{name:"水毁",value:n,percent:Object(i["a"])(n,o),color:"#FFD84A"}]}},mounted:function(){var e=this;this.$nextTick((function(){e.initMap(),e.refreshDataView()}))},methods:{previewPic:function(e){this.showPicScreen=!0,e.target.src&&(this.picSrc=e.target.src)},refreshMap:function(){var e=this.map;e.getZoom()},clearLayersFeatures:function(){this.clearBoundsFeatures(),this.clearPointLayerFeatures(),this.clearLinesLayerFeatures()},initMap:function(){var e=this,t=this,a=L.map("map",{center:[30.76,103.96],zoom:5,crs:L.supermap.CRS.TianDiTu_WGS84,zoomControl:!1});this.linesLayer=(new L.LayerGroup).addTo(a),this.pointLayer=(new L.LayerGroup).addTo(a);var r="1d109683f4d84198e37a38c442d68311";new L.supermap.TiandituTileLayer({layerType:"img",key:r}).addTo(a),new L.supermap.TiandituTileLayer({layerType:"img",isLabel:!0,key:r}).addTo(a);new L.supermap.TiledMapLayer("http://10.23.17.229:8090/iserver/services/map-gis-disaster--2--4/rest/maps/DataSourceGIS2-sichuan",{transparent:!0,noWrap:!0}).addTo(a);var s=L.icon({iconUrl:u.a,iconSize:[70,70]});c["earthquakeData"].map((function(r){var n=L.marker([r.latitude,r.longitude],{icon:s}).addTo(a);n.on("click",(function(){e.earthquakePoint=r,setTimeout((function(){t.riskdialogVisible1=!0}),300)}))})),this.map=a},polygonToGeoJSON:function(e){var t=e.getVertices(),a=t.map((function(e){return[e.x,e.y]})),r={type:"Feature",geometry:{type:"Polygon",coordinates:[a]},properties:{}};return r},boundsToGeometry:function(e){var t=e.getSouthWest(),a=e.getNorthEast(),r=[new SuperMap.Geometry.Point(t.lng,t.lat),new SuperMap.Geometry.Point(a.lng,t.lat),new SuperMap.Geometry.Point(a.lng,a.lat),new SuperMap.Geometry.Point(t.lng,a.lat),new SuperMap.Geometry.Point(t.lng,t.lat)],s=new SuperMap.Geometry.LinearRing(r);return new SuperMap.Geometry.Polygon([s])},clearBoundsFeatures:function(){this.map;if(this.resultBoundsLayer){var e=this.resultBoundsLayer;e.clearLayers()}},clearPointLayerFeatures:function(){this.map;if(this.pointLayer){var e=this.pointLayer;e.clearLayers()}},clearLinesLayerFeatures:function(){this.map;if(this.linesLayer){var e=this.linesLayer;e.clearLayers()}},loadLines:function(){this.clearLinesLayerFeatures();var e=this.map,t=this,a=e.getBounds(),r=new SuperMap.Bounds(a.getWest(),a.getSouth(),a.getEast(),a.getNorth()),s=["#0078FF","#FF5733","#2ECC71"],i=["DataSourceGIS2:gz_L21_52_G","DataSourceGIS2:gz_L21_52_S"],o=function(e,a,r,s,i){var u=r*l,c=u+l,p=new SuperMap.GetFeaturesByBoundsParameters({datasetNames:[e],bounds:a,returnContent:!0,fromIndex:u,toIndex:c}),m=new SuperMap.GetFeaturesByBoundsService(d);m.processAsync(p,(function(u){if(u.result&&u.result.features){var c=L.geoJSON(u.result.features,{style:{color:i,weight:5},onEachFeature:function(e,t){t.on("click",(function(){console.log(e,"1-----1");var a=e.properties,r=a.name||a.名称||"未命名线路",s=Object.entries(a).map((function(e){var t=Object(n["a"])(e,2),a=t[0],r=t[1];return"<b>".concat(a,":</b> ").concat(r)})).join("<br>");t.bindPopup("<h4>".concat(r,"</h4>").concat(s)).openPopup()}))}});t.linesLayer.addLayer(c),u.result.featureCount===l&&o(e,a,r+1,s,i)}}))};i.forEach((function(e,t){o(e,r,0,[],s[t%3])}))},loadLinesByBounds:function(e){this.clearBoundsFeatures();var t=this,a=this.map;t.loading=!0;var r=this.polygonToGeoJSON(this.boundsToGeometry(a.getBounds())),s=L.supermap.Util.transform(r,L.CRS.EPSG4326,L.CRS.EPSG3857),n=new L.supermap.QueryByGeometryParameters({queryParams:{name:"China_Province_pl@China"},featureCount:1e6,geometry:s,spatialQueryMode:SuperMap.SpatialQueryMode.INTERSECT}),i=new L.supermap.QueryService("http://10.23.17.229:8090/iserver/services/map-china400/rest/maps/China");i.queryByGeometry(n,(function(e){t.loading=!1;var r=L.supermap.Util.transform(e.result.recordsets[0].features,L.CRS.EPSG3857,L.CRS.EPSG4326);t.resultBoundsLayer=L.geoJSON(r).addTo(a)}))},renderVisiblePoints:function(){var e=this,t=this.map,a=this.pointLayer,r=t.getBounds(),s=r.getSouthWest(),i=r.getNorthEast(),o=L.icon.pulse({iconSize:[12,12],color:"#f00"});this.clearPointLayerFeatures();var u=new SuperMap.GetFeaturesByBoundsParameters({queryParams:{name:"address_disaster@DataSourceDisasterGIS",attributeFilter:"disaster_grade = '一级'"},datasetNames:["DataSourceDisasterGIS:address_disaster"],bounds:new SuperMap.Bounds(s.lng,s.lat,i.lng,i.lat),fromIndex:0,toIndex:50,spatialQueryMode:SuperMap.SpatialQueryMode.CONTAIN});L.supermap.featureService(d).getFeaturesByBounds(u,(function(t){var r=t.result.features.features;r.forEach((function(t){var r=Object(n["a"])(t.geometry.coordinates,2),s=r[0],i=r[1],u=L.marker([i,s],{icon:o}).addTo(a);u.on("click",(function(){})),e.pointLayer.addLayer(layer)}))}))},refreshDataView:function(){this.getDistrictDisaster(),this.getDisasterType(),this.getRectificationProgress()},getDistrictDisaster:function(){return Object(s["a"])(Object(r["a"])().mark((function e(){return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))()},getDisasterType:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a,s,n,i,o,u,c,l,m,h,y;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=function(e,t){var a=new L.supermap.GetFeaturesBySQLParameters({queryParameter:{name:e,attributeFilter:t},datasetNames:["DataSourceDisasterGIS:address_disaster"]});return a},s="ds_type = '崩塌'",t.next=4,e.queryDisasterDataset(d,a(p,s));case 4:return n=t.sent,e.disasterTypeModel.bt=n.result.totalCount||0,i="ds_type = '塌陷'",t.next=9,e.queryDisasterDataset(d,a(p,i));case 9:return o=t.sent,e.disasterTypeModel.tx=o.result.totalCount||0,u="ds_type = '滑坡'",t.next=14,e.queryDisasterDataset(d,a(p,u));case 14:return c=t.sent,e.disasterTypeModel.hp=c.result.totalCount||0,l="ds_type = '泥石流'",t.next=19,e.queryDisasterDataset(d,a(p,l));case 19:return m=t.sent,e.disasterTypeModel.nsl=m.result.totalCount||0,h="ds_type = '水毁'",t.next=24,e.queryDisasterDataset(d,a(p,h));case 24:y=t.sent,e.disasterTypeModel.sh=y.result.totalCount||0;case 26:case"end":return t.stop()}}),t)})))()},getRectificationProgress:function(){var e=this;return Object(s["a"])(Object(r["a"])().mark((function t(){var a,s,n,i,o,u,c;return Object(r["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=function(e,t){var a=new L.supermap.GetFeaturesBySQLParameters({queryParameter:{name:e,attributeFilter:t},datasetNames:["DataSourceDisasterGIS:address_disaster"]});return a},s="treatment_situation = '已处治修复' or treatment_situation = '未处治修复' or treatment_situation = '正在处治修复'",t.next=4,e.queryDisasterDataset(d,a(p,s));case 4:return n=t.sent,e.rectificationProgressModel.total=n.result.totalCount||0,i="treatment_situation = '已处治修复'",t.next=9,e.queryDisasterDataset(d,a(p,i));case 9:return o=t.sent,e.rectificationProgressModel.already=o.result.totalCount||0,u="treatment_situation = '正在处治修复' or treatment_situation = '未处治修复'",t.next=14,e.queryDisasterDataset(d,a(p,u));case 14:c=t.sent,e.rectificationProgressModel.deal=c.result.totalCount||0;case 16:case"end":return t.stop()}}),t)})))()},queryDisasterDataset:function(e,t){return new Promise((function(a,r){new L.supermap.FeatureService(e).getFeaturesBySQL(t).then((function(e){a(e)})).catch((function(e){r(e)}))}))}}}},"2b3e":function(e,t,a){"use strict";a.r(t),a.d(t,"earthquakeData",(function(){return r}));var r=[{id:1,time:"2025-03-20 03:35:34",latitude:27.01,longitude:103.42,depth_km:10,magnitude:3,location:"云南昭通市巧家县",images:["https://tse4-mm.cn.bing.net/th/id/OIP-C.zZWqbaNpxqzRa00NCnVA2QHaGh?rs=1&pid=ImgDetMain","https://img2.baidu.com/it/u=250791285,3998594525&fm=253&fmt=auto&app=120&f=JPEG?w=1583&h=800"]},{id:2,time:"2025-03-18 19:21:53",latitude:29.64,longitude:104.59,depth_km:8,magnitude:3.4,location:"四川内江市威远县",images:["https://cmsimg01.71360.com/data/u19727/public/2022030713422536621.jpg","https://n.sinaimg.cn/sinakd10109/154/w908h846/20200309/5ff1-iqrhckm4347398.jpg"]},{id:3,time:"2025-03-18 19:20:44",latitude:29.67,longitude:104.62,depth_km:8,magnitude:3.9,location:"四川内江市威远县",images:["https://cmsimg01.71360.com/data/u19727/public/2022030713422536621.jpg","https://n.sinaimg.cn/spider20221118/419/w1080h939/20221118/3b22-2bc5389d831b6b25c756dbf037cf42a9.jpg"]},{id:4,time:"2025-03-18 15:19:05",latitude:31.22,longitude:103.44,depth_km:10,magnitude:3.1,location:"四川阿坝州汶川县",images:["https://tse3-mm.cn.bing.net/th/id/OIP-C.JjfGanmvQU5VcC9dcvyGhgHaEl?rs=1&pid=ImgDetMain","https://tse3-mm.cn.bing.net/th/id/OIP-C.A6eYkmsND0NXvy_tQqksDAHaE-?rs=1&pid=ImgDetMain"]},{id:5,time:"2025-03-18 04:52:21",latitude:44.42,longitude:83.25,depth_km:19,magnitude:3.4,location:"新疆博尔塔拉州精河县",images:["https://img0.baidu.com/it/u=2070360633,2246311583&fm=253&fmt=auto&app=138&f=JPEG?w=828&h=500","https://img1.baidu.com/it/u=3921333363,410009474&fm=253&fmt=auto&app=138&f=JPEG?w=727&h=500"]},{id:6,time:"2025-03-18 00:35:05",latitude:38.13,longitude:75.71,depth_km:114,magnitude:3,location:"新疆克孜勒苏州阿克陶县",images:["https://img-xhpfm.oss-cn-hangzhou.aliyuncs.com/News/201708/20170810105906_4741.jpg","https://www.gov.cn/xinwen/2016-03/15/5053655/images/2dcfbe68a8a3402499df23ad4aaba4a3.jpg"]}]}}]);